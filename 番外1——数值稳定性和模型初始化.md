## æ•°å€¼ç¨³å®šæ€§å’Œæ¨¡å‹åˆå§‹åŒ–

#### æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸

åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œè¯¯å·®çš„åå‘ä¼ æ’­è¿­ä»£å…¬å¼ä¸º:
$$
\delta ^{(l)}=f'_l(z^{(l)}) âŠ™ (ğ‘¾^{(ğ‘™+1)})^Tğ›¿^{(ğ‘™+1)}
$$
è¯¯å·®ä»è¾“å‡ºå±‚åå‘ä¼ æ’­æ—¶ï¼Œåœ¨æ¯ä¸€å±‚éƒ½è¦ä¹˜ä»¥è¯¥å±‚æ¿€æ´»å‡½æ•°çš„å¯¼æ•°.å½“æˆ‘ä»¬ä½¿ç”¨sigmoidå‡½æ•°:logisticå‡½æ•°æˆ–è€…Tanhå‡½æ•°æ—¶ï¼Œä»–ä»¬çš„å¯¼æ•°å›¾åƒå¦‚ï¼š

![1684901450332](C:\Users\è£´è‹±è±ª\Desktop\æ€ç»´å¯¼å›¾æ€»ç»“\ç¬¬äºŒä¸ªæœˆ\æ·±åº¦å­¦ä¹ ç¬”è®°\source\sigmoid grad.png)

ä»–ä»¬çš„å¯¼æ•°éƒ½å°äº1ï¼Œåœ¨é¥±å’ŒåŒºï¼ˆæ­£è´Ÿå¾ˆå¤§çš„åŒºåŸŸï¼‰å¯¼æ•°æ›´æ˜¯æ¥è¿‘äº0ï¼Œé‚£ä¹ˆè¯¯å·®åœ¨ä¸æ–­åœ°ä¹˜çš„æ—¶å€™å°±ä¼šè¡°å‡ï¼Œå¦‚æœå±‚æ•°è¿‡å¤šç”šè‡³ä¼šæ¶ˆå¤±ï¼Œå¯¼è‡´æœ€å¼€å§‹åŸºå±‚çš„ä½œç”¨å‡ ä¹ä¸º0ï¼Œè¿™ç§ç°è±¡ç§°ä¸ºæ¢¯åº¦æ¶ˆå¤±ã€‚

åŒæ ·çš„ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å¦å¤–çš„æ¿€æ´»å‡½æ•°æˆ–è€…æ¨¡å‹ä¸Šè·Ÿmlpæœ‰åŒºåˆ«ï¼Œä»–çš„æ¢¯åº¦åœ¨æ·±åº¦è¾ƒæ·±çš„æƒ…å†µä¸‹ä¼šå‡ºç°æ¢¯åº¦çˆ†ç‚¸é—®é¢˜ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå¾ˆç®€å•çš„ä¾‹å­æ¥è¯´æ˜:

```python
%matplotlib inline
import torch
from d2l import torch as d2l

M = torch.normal(0, 1, size=(4,4))
print('ä¸€ä¸ªçŸ©é˜µ \n',M)
for i in range(100):
    M = torch.mm(M,torch.normal(0, 1, size=(4, 4)))

print('ä¹˜ä»¥100ä¸ªçŸ©é˜µå\n', M)

>>ä¸€ä¸ªçŸ©é˜µ 
 tensor([[-0.7476, -0.5905,  0.4594, -0.4446],
        [-0.6868, -0.1769, -1.6432, -1.1101],
        [ 0.2385, -1.6487,  1.3177,  0.1729],
        [ 0.7691, -0.2316, -1.6668, -0.2459]])
ä¹˜ä»¥100ä¸ªçŸ©é˜µå
 tensor([[ 1.2614e+24, -2.9730e+24, -2.1424e+24, -3.2076e+24],
        [ 5.6098e+24, -1.3223e+25, -9.5285e+24, -1.4266e+25],
        [-2.1604e+24,  5.0921e+24,  3.6694e+24,  5.4939e+24],
        [ 2.1933e+24, -5.1700e+24, -3.7257e+24, -5.5779e+24]])
```





#### è¿™é‡Œæˆ‘ä»¬å…ˆç®€å•ä»‹ç»ä¸€ç§å‚æ•°åˆå§‹åŒ–çš„æ–¹æ³•æ¥è§£å†³ï¼ˆå‡è½»ï¼‰

**Xavieråˆå§‹åŒ–**

æˆ‘ä»¬å…ˆå‡è®¾æƒé‡éƒ½æ˜¯ä»åŒä¸€åˆ†å¸ƒä¸­ç‹¬ç«‹æ”¶å–å‡ºæ¥çš„ï¼Œè¿™ä¸ªåˆ†å¸ƒçš„æœŸæœ›ä¸º0ï¼Œä»–çš„æ–¹å·®ä¸º$\sigma^2$.æˆ‘ä»¬ä¸è¦æ±‚ä»–æ˜¯é«˜æ–¯åˆ†å¸ƒï¼Œæˆ‘ä»¬æ¥å‡è®¾è¿™ä¸ªå±‚çš„å…¨è¿æ¥è¾“å‡º$o_i$çš„åˆ†å¸ƒï¼š$o_{i} = \sum_{j=1}^{n_\mathrm{in}} w_{ij} x_j$,ä¸éš¾ç†è§£ï¼Œå®é™…ä¸Šæ˜¯æƒé‡æ±‚å’Œå˜›ã€‚ä¸è¿‡æˆ‘ä»¬å‡è®¾è¾“å…¥$x_j$çš„è¾“å…¥ä¹Ÿæœ‰é›¶å‡å€¼å’Œæ–¹å·®$\gamma^2$ï¼Œä»–ä»¬å‡ç‹¬ç«‹ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¾“å‡º$o_j$çš„å¹³å‡å€¼å’Œæ–¹å·®:
$$
\begin{split}\begin{aligned}
    E[o_i] & = \sum_{j=1}^{n_\mathrm{in}} E[w_{ij} x_j] \\&= \sum_{j=1}^{n_\mathrm{in}} E[w_{ij}] E[x_j] \\&= 0, \\
    \mathrm{Var}[o_i] & = E[o_i^2] - (E[o_i])^2 \\
        & = \sum_{j=1}^{n_\mathrm{in}} E[w^2_{ij} x^2_j] - 0 \\
        & = \sum_{j=1}^{n_\mathrm{in}} E[w^2_{ij}] E[x^2_j] \\
        & = n_\mathrm{in} \sigma^2 \gamma^2.
\end{aligned}\end{split}
$$
å› ä¸º$n_\mathrm{in} \sigma^2 $ç›¸å½“äºæ˜¯æˆ‘ä»¬äººä¸ºç»™çš„ä¸€ä¸ªæ‰°åŠ¨ï¼Œä¸€ä¸ªç³»æ•°ï¼Œä¸€ä¸ªå†³å®šäº†å‰å‘çš„ä¸æ–­ä¼ é€’ç»™ç»“æœæ–¹å·®å¤§å°å¸¦æ¥çš„å½±å“ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥å°½é‡å‡å°‘å®ƒçš„å½±å“ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»¤$n_\mathrm{in} \sigma^2 = 1$ã€‚ä½†æ˜¯æˆ‘ä»¬ä»¤$n_\mathrm{in} \sigma^2=1 $åªä¿è¯äº†å‰å‘ä¼ æ’­çš„æ—¶å€™æ•°å€¼ä¸ä¼šæœ‰å¾ˆå¤§çš„å˜åŠ¨ï¼Œä½†æ˜¯åå‘ä¼ æ’­å‘¢ï¼Ÿç±»æ¯”æ€è€ƒï¼Œé‚£æˆ‘ä»¬åº”è¯¥éœ€è¦è®©$n_\mathrm{out} \sigma^2 = 1$ï¼Œä½†æ˜¯ä¸¤è€…ä¸å¯å¾—å…¼ï¼Œäºæ˜¯æˆ‘ä»¬è¿›è¡Œæ»¡è¶³:
$$
\begin{aligned}
\frac{1}{2} (n_\mathrm{in} + n_\mathrm{out}) \sigma^2 = 1 \text{ æˆ–ç­‰ä»·äº }
\sigma = \sqrt{\frac{2}{n_\mathrm{in} + n_\mathrm{out}}}.
\end{aligned}\\
$$
å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„inå’Œoutå®é™…ä¸Šéƒ½æ˜¯å‚æ•°çŸ©é˜µçš„ä¸€ç»´ï¼Œæˆ‘ä»¬ç”¨$n_i$è¡¨ç¤ºç¬¬iå±‚çš„è¾“å…¥ï¼Œç”¨$n_{i+1}$è¡¨ç¤ºç¬¬i+1å±‚çš„è¾“å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ–¹å·®å°±å¯ä»¥è¡¨è¾¾æˆ:
$$
\begin{aligned}
\frac{1}{2} (n_\mathrm{i} + n_\mathrm{i+1}) \sigma^2 = 1 \text{ æˆ–ç­‰ä»·äº }
\sigma = \sqrt{\frac{2}{n_\mathrm{i} + n_\mathrm{i+1}}}.
\end{aligned}
$$
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨é«˜æ–¯åˆ†å¸ƒ$N(0,\sigma^2)=N(0,\frac{2}{n_\mathrm{in} + n_\mathrm{out}})$ï¼Œè¿›è¡Œåˆå§‹åŒ–ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æ”¹ç”¨å‡åŒ€åˆ†å¸ƒï¼šæ³¨æ„å‡åŒ€åˆ†å¸ƒ$U(âˆ’a,a)$çš„æ–¹å·®ä¸º$\frac{a^2}{3}$ã€‚ å°†$\frac{a^2}{3}$ä»£å…¥åˆ°$\sigma ^2$çš„æ¡ä»¶ä¸­ï¼Œå°†å¾—åˆ°åˆå§‹åŒ–å€¼åŸŸï¼š
$$
U\left(-\sqrt{\frac{6}{n_\mathrm{in} + n_\mathrm{out}}}, \sqrt{\frac{6}{n_\mathrm{in} + n_\mathrm{out}}}\right).
$$
